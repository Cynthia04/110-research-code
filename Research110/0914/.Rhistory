m=1000;N=1000;k=30;sigma=0.1
a <-c();theta <- c()
y0 <- rbinom(1,50,0.8)
u <- runif(m+N*k)
for(i in 1:(m+N*k)){
repeat{
z <- rnorm(1,theta0,sigma)
if(z>0 & z<1){break}
}
a[i] <- alpha <- min(posterior(z,y0)/posterior(theta0,y0),1)
if(alpha>u[i]){
theta[i] <- z
}else{
theta[i] <- theta0
}
theta0 <- theta[i]
}
m=1000;N=1000;k=30;theta0=0.5;sigma=0.1
a <-c();theta <- c()
y0 <- rbinom(1,50,0.8)
u <- runif(m+N*k)
for(i in 1:(m+N*k)){
repeat{
z <- rnorm(1,theta0,sigma)
if(z>0 & z<1){break}
}
a[i] <- alpha <- min(posterior(z,y0)/posterior(theta0,y0),1)
if(alpha>u[i]){
theta[i] <- z
}else{
theta[i] <- theta0
}
theta0 <- theta[i]
}
posterior <- function(theta,y){(theta^(y-0.5))*((1-theta)^(50-y-0.5))}
m=1000;N=1000;k=30;theta0=0.5;sigma=0.1
a <-c();theta <- c()
y0 <- rbinom(1,50,0.8)
u <- runif(m+N*k)
for(i in 1:(m+N*k)){
repeat{
z <- rnorm(1,theta0,sigma)
if(z>0 & z<1){break}
}
a[i] <- alpha <- min(posterior(z,y0)/posterior(theta0,y0),1)
if(alpha>u[i]){
theta[i] <- z
}else{
theta[i] <- theta0
}
theta0 <- theta[i]
}
theta
theta[seq(m+k,m+N*k,k)]
mean(theta[seq(m+k,m+N*k,k)])
