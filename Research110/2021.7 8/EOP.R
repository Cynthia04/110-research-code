t3est <- c(9.14*10^(-2),1.02*10^(-3),2.1*10^(-4),1.12*10^(-5),2.92*10^(-3),4.42*10^(-4))
t3reg <- c(9.15*10^(-2),1*10^(-3),2.07*10^(-4),1.2*10^(-5),1.72*10^(-3),3.46*10^(-4))

S0 <- c()
for (i in c(1,3,5)){
  t <- t3reg[i]+0.5*t3reg[i+1]
  S0 <- append(S0,t)
}
S0
EZ <- function(i){
  a <- S0[1];b <- S0[2];s <- S0[3]
  k <- a/b
  1/b*(log((i+k)/(i-1+k))+s^2/2*((i-1)/(i-1+k)^2-i/(i+k)^2))
}
EZ(154)

x=1;ans <- EZ(x)
while( ans>8){
  x=x+1 
  ans=EZ(x)
}
x
ans






